<!DOCTYPE html>
<html>

<head>
  <script id="adobe_dtm" src="//www.redhat.com/dtm.js" type="text/javascript"></script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Making WildFly Glow with Intelligence</title>
  <meta name="description" content="">
  <link rel="me" href="https://fosstodon.org/@wildflyas" />
  <link rel="shortcut icon" type="image/png" href="/wildfly.org/favicon.ico" >
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/base16/atelier-dune-light.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/protobuf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/dockerfile.min.js"></script>
  <link rel="stylesheet" href="/wildfly.org/assets/css/main.css" />
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-40221748-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-40221748-1');
  </script>

  

</head>

<body class="Making WildFly Glow with Intelligence">
  <div class="content">
    <div class="header navigation">
  <div class="logo-wrapper">
    <a href="/wildfly.org/"><img class="wf-logo" src="/wildfly.org/assets/img/wildfly_icons_one-color-logo.png"></a>
  </div>
  <div class="nav-container">
    <nav>
      <div class="nav-mobile"><a id="nav-toggle" href="#!"><span></span></a></div>
      <ul class="nav-list">
        <li>
          <a href="/wildfly.org/news/" class="active">News</a>
        </li>
        <li>
          <a href="/wildfly.org/about/" class="">About</a>
        </li>
        <li>
          <a href="/wildfly.org/contribute/" class="">Contribute</a>
        </li>
        <li>
            <a target="_blank" href="https://docs.wildfly.org">Docs</a>
        </li>
        <li>
          <a href="/wildfly.org/guides/" class="">Guides</a>
        </li>
        <li>
          <a href="/wildfly.org/events/" class="">Events</a>
        </li>
        <li>
          <a href="/wildfly.org/downloads/" class="">Downloads</a>
        </li>
        <li>
          <a href="/wildfly.org/security/" class="">CVE Reporting</a>
        </li>
        <li>
          <a href="https://github.com/wildfly/wildfly/fork" target="_blank">Fork</a>
        </li>
        <li>
          <a class="button-cta secondary " href="/wildfly.org/get-started/">Get Started</a>
        </li>
      </ul>
    </nav>
  </div>
</div>

    <div class="post-page grid-wrapper">
  <div class="grid__item width-10-12">
    <h1 class="title">Making WildFly Glow with Intelligence</h1>
    
    
    

    <p>
      
        
          
          <p class="byline">
            
              <img class="avatar" height="60px" width="60px" src="/assets/img/authors/ehsavoie.png"/>
            

            By Emmanuel Hugonnet
            
              | February 10, 2025
            
          </p>
        
      
    </p>
  </div>
  <div class="grid__item width-10-12 doc-content">
    
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In WildFly 35 Beta, WildFly Glow has also received a new feature to <a href="https://docs.wildfly.org/wildfly-proposals/wf-galleon/WFLY-19855_glow_spaces.html" target="_blank" rel="noopener">introduce spaces to structure discovered Galleon feature-packs</a>, this allows feature packs to be grouped into spaces such as an incubating space to reflect the stability of the feature pack and to allow users to select which spaces they want to use.</p>
</div>
<div class="paragraph">
<p>One of the first feature pack to take advantage of that is the <a href="https://github.com/wildfly-extras/wildfly-ai-feature-pack">WildFly AI Feature Pack</a> using the new <strong>incubating</strong> space.</p>
</div>
<div class="paragraph">
<p>In this article I will show you how you can take advantage of this to provision a Generative AI server.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="wildfly-ai-feature-pack">WildFly AI Feature Pack</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since my first article the WildFly AI Feature Pack has evolved quite a bit. Of course we are following <a href="https://docs.langchain4j.dev/">LangChain4J</a> and <a href="https://github.com/smallrye/smallrye-llm">smallrye-llm</a> evolutions.</p>
</div>
<div class="paragraph">
<p>We have also added support for streaming tokens making the interaction lot more lively. Now, it is providing OpenTelemetry support to track your LLM usage and integrating with WildFly Glow to provide a default configuration on provisioning a lot easier.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s dive into this new feature.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="wildfly-ai-feature-pack-layers">WildFly AI Feature Pack layers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Currently the feature-pack provides 18 Galleon layers that build upon each other :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Support for chat models to interact with a LLM:</p>
<div class="ulist">
<ul>
<li>
<p><em>mistral-ai-chat-model</em></p>
</li>
<li>
<p><em>ollama-chat-model</em></p>
</li>
<li>
<p><em>groq-chat-model</em> (same as openai-chat-model but targeting Groq)</p>
</li>
<li>
<p><em>openai-chat-model</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Support for embedding models:</p>
<div class="ulist">
<ul>
<li>
<p><em>in-memory-embedding-model-all-minilm-l6-v2</em></p>
</li>
<li>
<p><em>in-memory-embedding-model-all-minilm-l6-v2-q</em></p>
</li>
<li>
<p><em>in-memory-embedding-model-bge-small-en</em></p>
</li>
<li>
<p><em>in-memory-embedding-model-bge-small-en-q</em></p>
</li>
<li>
<p><em>in-memory-embedding-model-bge-small-en-v15</em></p>
</li>
<li>
<p><em>in-memory-embedding-model-bge-small-en-v15-q</em></p>
</li>
<li>
<p><em>in-memory-embedding-model-e5-small-v2</em></p>
</li>
<li>
<p><em>in-memory-embedding-model-e5-small-v2-q</em></p>
</li>
<li>
<p><em>ollama-embedding-model</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Support for embedding stores:</p>
<div class="ulist">
<ul>
<li>
<p><em>in-memory-embedding-store</em></p>
</li>
<li>
<p><em>neo4j-embedding-store</em></p>
</li>
<li>
<p><em>weaviate-embedding-store</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Support for content retriever for RAG:</p>
<div class="ulist">
<ul>
<li>
<p><em>default-embedding-content-retriever</em>: default content retriever using an in-memory-embedding-store and in-memory-embedding-model-all-minilm-l6-v2 for embedding model.</p>
</li>
<li>
<p><em>web-search-engines</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more details on these you can take a look at <a href="https://docs.langchain4j.dev/">LangChain4J</a> and <a href="https://github.com/smallrye/smallrye-llm">Smallrye-llm</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="provisioning-the-server-with-glow">Provisioning the server with Glow</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We are going to use the <a href="https://github.com/wildfly-extras/wildfly-mcp/tree/main/wildfly-chat-bot">chabot example</a> of the <a href="https://github.com/wildfly-extras/wildfly-mcp">WildFly MCP</a>.</p>
</div>
<div class="paragraph">
<p>The initial way to provision our server was to define the layers in the <em>pom.xml</em> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;groupId&gt;org.wildfly.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;wildfly-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;${version.wildfly.maven.plugin}&lt;/version&gt;
    &lt;configuration&gt;
        &lt;feature-packs&gt;
            &lt;feature-pack&gt;
                &lt;location&gt;org.wildfly:wildfly-galleon-pack:${version.wildfly.server}&lt;/location&gt;*
            &lt;/feature-pack&gt;
            &lt;feature-pack&gt;
                &lt;location&gt;org.wildfly:wildfly-ai-feature-pack:${version.wildfly.ai.feature.pack}&lt;/location&gt;
            &lt;/feature-pack&gt;
        &lt;/feature-packs&gt;
        &lt;layers&gt;
            &lt;layer&gt;ee-core-profile-server&lt;/layer&gt;
            &lt;layer&gt;jaxrs&lt;/layer&gt;
            &lt;layer&gt;ollama-chat-model&lt;/layer&gt;
            &lt;layer&gt;groq-chat-model&lt;/layer&gt;
            &lt;layer&gt;openai-chat-model&lt;/layer&gt;
            &lt;layer&gt;default-embedding-content-retriever&lt;/layer&gt;
        &lt;/layers&gt;
        &lt;name&gt;ROOT.war&lt;/name&gt;
        &lt;bootableJar&gt;true&lt;/bootableJar&gt;
        &lt;packagingScripts&gt;
            &lt;packaging-script&gt;
                &lt;scripts&gt;
                    &lt;script&gt;./src/scripts/configure_server.cli&lt;/script&gt;
                &lt;/scripts&gt;
            &lt;/packaging-script&gt;
        &lt;/packagingScripts&gt;
    &lt;/configuration&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;goals&gt;
                &lt;goal&gt;package&lt;/goal&gt;
            &lt;/goals&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>But using WildFly Glow we can make that way simpler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;groupId&gt;org.wildfly.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;wildfly-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;${version.wildfly.maven.plugin}&lt;/version&gt;
    &lt;configuration&gt;
        &lt;discoverProvisioningInfo&gt;
            &lt;version&gt;${version.wildfly.server}&lt;/version&gt;
            &lt;spaces&gt;
                &lt;space&gt;incubating&lt;/space&gt;
            &lt;/spaces&gt;
        &lt;/discoverProvisioningInfo&gt;
        &lt;name&gt;ROOT.war&lt;/name&gt;
        &lt;bootableJar&gt;true&lt;/bootableJar&gt;
        &lt;packagingScripts&gt;
            &lt;packaging-script&gt;
                &lt;scripts&gt;
                    &lt;script&gt;./src/scripts/configure_server.cli&lt;/script&gt;
                &lt;/scripts&gt;
            &lt;/packaging-script&gt;
        &lt;/packagingScripts&gt;
    &lt;/configuration&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;goals&gt;
                &lt;goal&gt;package&lt;/goal&gt;
            &lt;/goals&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>AS you can see we are using the <em>discoverProvisioningInfo</em> element to define which version of WildFly server we want to start from. AS you can see we have added an incubating  <em>space</em> which enables the discovery of the WildFly AI Feature Pack.</p>
</div>
<div class="paragraph">
<p>Now when we run Apache Maven we can see the following traces :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/wildfly.org/assets/img/news/ai/glow_ai_fp.png" alt="Glow traces">
</div>
</div>
<div class="paragraph">
<p>As you can see, Glow discovered the use of the following LLMs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ollama-chat-model</p>
</li>
<li>
<p>openai-chat-model</p>
</li>
<li>
<p>groq-chat-model</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>How did Glow found those ?</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="how-glow-works-under-the-hood-for-the-wildfly-ai-feature-pack">How Glow works under the hood for the WildFly AI Feature Pack ?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here is where the magic is happening :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ServerEndpoint(value = "/chatbot",
        configurator = CustomConfigurator.class)
public class ChatBotWebSocketEndpoint {

    private static final Logger logger = Logger.getLogger(ChatBotWebSocketEndpoint.class.getName());

    @Inject
    @Named(value = "ollama")
    ChatLanguageModel ollama;
    @Inject
    @Named(value = "openai")
    ChatLanguageModel openai;
    @Inject
    @Named(value = "groq")
    ChatLanguageModel groq;
    //@Inject Instance&lt;ChatLanguageModel&gt; instance;
    private PromptHandler promptHandler;
    private Bot bot;
    private List&lt;McpClient&gt; clients = new ArrayList&lt;&gt;();
    private final List&lt;McpTransport&gt; transports = new ArrayList&lt;&gt;();
    private Session session;
    private final ExecutorService executor = Executors.newFixedThreadPool(1);
    private final BlockingQueue&lt;String&gt; workQueue = new ArrayBlockingQueue&lt;&gt;(1);

    // It starts a Thread that notifies all sessions each second
    @PostConstruct
    public void init() {
    ...
    }
...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, we inject <em>dev.langchain4j.model.chat.ChatLanguageModel</em> in the <em>org.wildfly.ai.chatbot. ChatBotWebSocketEndpoint</em> using a <em>@Named</em> annotation. This is the rule that Glow uses to detect what the application is using.</p>
</div>
<div class="paragraph">
<p>You can see the Glow rule <a href="https://github.com/wildfly-extras/wildfly-ai-feature-pack/blob/main/ai-feature-pack/src/main/resources/layers/standalone/ollama-chat-model/layer-spec.xml#L11">here</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;prop name="org.wildfly.rule.annotated.type" value="dev.langchain4j.model.chat.ChatLanguageModel,jakarta.inject.Named[value=ollama]"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>So this explain why Glow is detecting that the WildFly MCP application is using <strong>Groq</strong>,<strong>OpenAI</strong> and <strong>Ollama</strong>.</p>
</div>
<div class="paragraph">
<p>Of course, similar rules exist for the embedding models and embedding store.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="in-conclusion">In conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As you could see, developping a Generative AI application using WildFly Glow and the WildFly AI Feature Pack is, as Duke Nukem used to say, a piece of cake.</p>
</div>
</div>
</div>
    
  </div>
</div>



  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/wildfly.org/"><img class="wf-logo" src="/wildfly.org/assets/img/wildfly_icons_one-color-logo.png"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">WildFly is fully open. All components are open source and follow a community-focused development process.<br/><br/>This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a> is hosted on <a href='https://pages.github.com/' target='_blank'>Github Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/wildfly/wildfly.org/fork' target='_blank'>fork it</a> and show us what youâ€™ve got.</p>

    
      <div class="width-1-12 project-links">
        <strong>Navigation</strong>
        <ul class="footer-links width-1-12">
          
            <li><a href="/downloads">Downloads</a></li>
          
            <li><a href="https://docs.wildfly.org">Docs</a></li>
          
            <li><a href="/get-started">Get Started</a></li>
          
            <li><a href="https://github.com/wildfly/wildfly">Github</a></li>
          
            <li><a href="/guides">Guides</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <strong>Contribute</strong>
        <ul class="footer-links width-1-12">
          
            <li><a href="https://issues.jboss.org/browse/WFLY">Submit a bug</a></li>
          
            <li><a href="https://groups.google.com/forum/#!forum/wildfly">Join the forum</a></li>
          
            <li><a href="https://github.com/wildfly/wildfly/fork">Fork WildFly</a></li>
          
            <li><a href="https://twitter.com/WildFlyAS">Follow us</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <strong>Get Help</strong>
        <ul class="footer-links width-1-12">
          
            <li><a href="https://groups.google.com/forum/#!forum/wildfly">Join the forum</a></li>
          
            <li><a href="https://wildfly.zulipchat.com/">Join Zulip Chat</a></li>
          
        </ul>
      </div>
    

    
      <div class="width-6-12 more-links">
        <strong>Find more Red Hat Middleware Community Projects</strong>
        <ul class="footer-links">
          
            <li><a href="https://www.apiman.io/">APIMan</a></li>
          
            <li><a href="http://arquillian.org">Arquillian</a></li>
          
            <li><a href="https://github.com/ansible-middleware/wildfly">Ansible Collection for Wildfly</a></li>
          
            <li><a href="http://byteman.jboss.org/">Byteman</a></li>
          
            <li><a href="http://capedwarf.org/">CapeDwarf</a></li>
          
            <li><a href="https://github.com/alechenninger/chronicler">Chronicler</a></li>
          
            <li><a href="https://github.com/darcy-framework">Darcy</a></li>
          
            <li><a href="http://debezium.io/">Debezium</a></li>
          
            <li><a href="https://www.drools.org/">Drools</a></li>
          
            <li><a href="http://gatein.jboss.org/">GateIn</a></li>
          
            <li><a href="http://www.hawkular.org/">Hawkular</a></li>
          
            <li><a href="http://hawt.io/">Hawtio</a></li>
          
            <li><a href="http://hibernate.org/">Hibernate</a></li>
          
            <li><a href="http://www.infinispan.org/">Infinispan</a></li>
          
            <li><a href="https://developers.redhat.com/products/codeready-studio/overview">CodeReady Studio</a></li>
          
            <li><a href="http://forge.jboss.org/">JBoss Forge</a></li>
          
            <li><a href="https://github.com/jboss-logging">JBoss Logging</a></li>
          
            <li><a href="http://jbossremoting.jboss.org/">JBoss Remoting</a></li>
          
            <li><a href="https://www.jbpm.org/">jBPM</a></li>
          
            <li><a href="https://jsfunit.jboss.org/">JSFUnit</a></li>
          
            <li><a href="https://www.keycloak.org/">Keycloak</a></li>
          
            <li><a href="http://modcluster.io/">Mod Cluster</a></li>
          
            <li><a href="http://modeshape.jboss.org/">ModeShape</a></li>
          
            <li><a href="https://www.optaplanner.org/">OptaPlanner</a></li>
          
            <li><a href="https://quarkus.io/">Quarkus</a></li>
          
            <li><a href="http://resteasy.jboss.org/">RESTEasy</a></li>
          
            <li><a href="https://riftsaw.jboss.org/">Riftsaw</a></li>
          
            <li><a href="http://savara.jboss.org/">Savara</a></li>
          
            <li><a href="https://weld.cdi-spec.org/">Weld</a></li>
          
            <li><a href="http://arquillian.org/">Shrinkwrap</a></li>
          
            <li><a href="https://switchyard.jboss.org/">Switchyard</a></li>
          
            <li><a href="https://tattletale.jboss.org/">Tattletale</a></li>
          
            <li><a href="https://teiid.io/">Teiid</a></li>
          
            <li><a href="https://wildfly-security.github.io/wildfly-elytron/">WildFly Elytron</a></li>
          
            <li><a href="http://wise.jboss.org/">Wise</a></li>
          
            <li><a href="https://xnio.jboss.org/">XNIO</a></li>
          
        </ul>
      </div>
    
  </div>
</div>
  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/wildfly.org/assets/img/redhat_reversed.svg"></a>
    </span>
  </div>
</div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script type="text/javascript" src="/wildfly.org/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/wildfly.org/assets/javascript/random-color-picker.js"></script>
  <script type="text/javascript">
    if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
        _satellite.pageBottom();
    }
    hljs.highlightAll();
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script>
  <script type="text/javascript" src="/wildfly.org/assets/javascript/copy.js"></script>

</body>

</html>
